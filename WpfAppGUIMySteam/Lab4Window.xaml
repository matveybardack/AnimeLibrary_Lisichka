<Window x:Class="WpfAppGUIMySteam.Lab4Window"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ЛР-4: Логические функции"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        Background="#0f3460">

    <Window.Resources>
        <!-- Стили в японском стиле -->
        <Style x:Key="AnimeCard" TargetType="Border">
            <Setter Property="Background" Value="#1a1a2e"/>
            <Setter Property="BorderBrush" Value="#e94560"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Margin" Value="10"/>
            <Setter Property="Padding" Value="15"/>
        </Style>

        <Style x:Key="AnimeButton" TargetType="Button">
            <Setter Property="Background" Value="#e94560"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style x:Key="TabItemStyle" TargetType="TabItem">
            <Setter Property="Background" Value="#16213e"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#e94560"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>

        <Style x:Key="CodeBox" TargetType="TextBox">
            <Setter Property="Background" Value="#16213e"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#e94560"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <Grid>
        <!-- Фон -->
        <Image Source="/Images/yakuza-0-goro-majima-kiryu-kazuma.jpg" 
               Stretch="UniformToFill" Opacity="0.3"/>

        <DockPanel>
            <!-- Заголовок -->
            <Border DockPanel.Dock="Top" 
                    Background="#1a1a2e" 
                    Padding="15" 
                    BorderThickness="0,0,0,2" 
                    BorderBrush="#e94560">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Button Content="Назад" 
                            Style="{StaticResource AnimeButton}"
                            Command="{Binding BackCommand}"
                            Background="#16213e"
                            Grid.Column="0"/>

                    <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                        <TextBlock Text="論理関数 - アニメ図書館" 
                                   Foreground="White" 
                                   FontSize="16" 
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="ЛР-4: Логические функции - фильтры для библиотеки аниме" 
                                   Foreground="#f8c3af" 
                                   FontSize="12"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Основной контент -->
            <TabControl Background="Transparent" BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem" BasedOn="{StaticResource TabItemStyle}"/>
                </TabControl.Resources>

                <!-- Вкладка 1: По номеру функции -->
                <TabItem Header="🔢 По номеру функции">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Левая колонка - ввод -->
                            <StackPanel Grid.Column="0" Margin="0,0,10,0">

                                <Border Style="{StaticResource AnimeCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="📊 Ввод параметров" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Margin="0,0,5,0">
                                                <TextBlock Text="Число переменных (n)" Foreground="#cccccc" FontSize="12"/>
                                                <TextBox Text="{Binding VariableCount}"
                                                         Background="#16213e" 
                                                         Foreground="White" 
                                                         BorderBrush="#e94560"
                                                         Height="25"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="1" Margin="5,0,0,0">
                                                <TextBlock Text="Номер функции" Foreground="#cccccc" FontSize="12"/>
                                                <TextBox Text="{Binding FunctionNumber}"
                                                         Background="#16213e" 
                                                         Foreground="White" 
                                                         BorderBrush="#e94560"
                                                         Height="25"/>
                                            </StackPanel>
                                        </Grid>

                                        <TextBlock Text="Переменные для библиотеки аниме:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   Margin="0,10,0,5"/>
                                        <TextBox Text="{Binding VariableNames}"
                                                 Background="#16213e" 
                                                 Foreground="White" 
                                                 BorderBrush="#e94560"
                                                 Height="25"/>

                                        <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                            <Button Content="Построить таблицу" 
                                                    Style="{StaticResource AnimeButton}"
                                                    Command="{Binding BuildByNumberCommand}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource AnimeCard}">
                                    <StackPanel>
                                        <TextBlock Text="💡 Примеры для библиотеки аниме" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <TextBlock Text="Фильтр по жанру и рейтингу:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"/>
                                        <TextBox Text="(Жанр == 'Сёнэн') &amp; (Рейтинг > 7)"
                                                 Style="{StaticResource CodeBox}"
                                                 Height="25"
                                                 IsReadOnly="True"/>

                                        <TextBlock Text="Умный фильтр:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   Margin="0,5,0,0"/>
                                        <TextBox Text="(Жанр == 'Романтика') | (Рейтинг > 8)"
                                                 Style="{StaticResource CodeBox}"
                                                 Height="25"
                                                 IsReadOnly="True"/>

                                        <TextBlock Text="Сравнение фильтров:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   Margin="0,5,0,0"/>
                                        <TextBox Text="!(Жанр == 'Драма') и (Жанр == 'Сёнэн') | (Жанр == 'Фэнтези')"
                                                 Style="{StaticResource CodeBox}"
                                                 Height="25"
                                                 IsReadOnly="True"/>
                                    </StackPanel>
                                </Border>

                            </StackPanel>

                            <!-- Правая колонка - результаты -->
                            <StackPanel Grid.Column="1" Margin="10,0,0,0">

                                <Border Style="{StaticResource AnimeCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="📋 Таблица истинности" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <DataGrid ItemsSource="{Binding TruthTable}"
                                                  Background="#16213e"
                                                  Foreground="White"
                                                  BorderBrush="#e94560"
                                                  AutoGenerateColumns="True"
                                                  Height="200"
                                                  IsReadOnly="True"/>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource AnimeCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="🎯 Нормальные формы" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <TextBlock Text="Совершенная дизъюнктивная нормальная форма (СДНФ):" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"/>
                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding DnfForm}"
                                                 Height="40"
                                                 IsReadOnly="True"/>

                                        <TextBlock Text="Совершенная конъюнктивная нормальная форма (СКНФ):" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   Margin="0,5,0,0"/>
                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding KnfForm}"
                                                 Height="40"
                                                 IsReadOnly="True"/>

                                        <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                            <Button Content="Копировать СДНФ" 
                                                    Style="{StaticResource AnimeButton}"
                                                    Command="{Binding CopyDnfCommand}"/>
                                            <Button Content="Копировать СКНФ" 
                                                    Style="{StaticResource AnimeButton}"
                                                    Command="{Binding CopyKnfCommand}"
                                                    Margin="5,0,0,0"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource AnimeCard}">
                                    <StackPanel>
                                        <TextBlock Text="📈 Статистика формулы" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="Литералов" Foreground="#cccccc" FontSize="12"/>
                                                <TextBlock Text="{Binding LiteralsCount}" 
                                                           Foreground="#e94560" 
                                                           FontSize="12"
                                                           FontWeight="Bold"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="Конъюнктов" Foreground="#cccccc" FontSize="12"/>
                                                <TextBlock Text="{Binding ConjunctionsCount}" 
                                                           Foreground="#e94560" 
                                                           FontSize="12"
                                                           FontWeight="Bold"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2">
                                                <TextBlock Text="Дизъюнктов" Foreground="#cccccc" FontSize="12"/>
                                                <TextBlock Text="{Binding DisjunctionsCount}" 
                                                           Foreground="#e94560" 
                                                           FontSize="12"
                                                           FontWeight="Bold"/>
                                            </StackPanel>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                </TabItem>

                <!-- Вкладка 2: По формуле -->
                <TabItem Header="📝 По формуле">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Левая колонка - ввод формулы -->
                            <StackPanel Grid.Column="0" Margin="0,0,10,0">

                                <Border Style="{StaticResource AnimeCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="✏️ Ввод логической формулы" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <TextBlock Text="Поддерживаемые операторы: Операции: ! — НЕ, &amp; — И, | — ИЛИ, ^ — XOR, -> — импликация, = — эквиваленция." 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   TextWrapping="Wrap"
                                                   Margin="0,0,0,5"/>

                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding FormulaInput}"
                                                 Height="80"
                                                 TextWrapping="Wrap"/>

                                        <TextBlock Text="Переменные (через запятую):" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   Margin="0,10,0,0"/>
                                        <TextBox Text="{Binding FormulaVariables}"
                                                 Background="#16213e" 
                                                 Foreground="White" 
                                                 BorderBrush="#e94560"
                                                 Height="25"/>

                                        <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                            <Button Content="Разобрать и вычислить" 
                                                    Style="{StaticResource AnimeButton}"
                                                    Command="{Binding ParseFormulaCommand}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource AnimeCard}">
                                    <StackPanel>
                                        <TextBlock Text="📖 Справка по операторам" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <ItemsControl ItemsSource="{Binding OperatorsHelp}">
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Background="#16213e" 
                                                            Margin="1" 
                                                            Padding="5" 
                                                            CornerRadius="3">
                                                        <TextBlock Text="{Binding}" 
                                                                   Foreground="White" 
                                                                   FontSize="12"/>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>
                                </Border>

                            </StackPanel>

                            <!-- Правая колонка - результаты формулы -->
                            <StackPanel Grid.Column="1" Margin="10,0,0,0">

                                <Border Style="{StaticResource AnimeCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="🔍 Результаты разбора" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <TextBlock Text="Обратная польская запись:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"/>
                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding ReversePolishNotation}"
                                                 Height="30"
                                                 IsReadOnly="True"/>

                                        <TextBlock Text="Развернутая формула в базисе {¬, ∧, ∨}:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   Margin="0,5,0,0"/>
                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding ExpandedFormula}"
                                                 Height="40"
                                                 IsReadOnly="True"/>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource AnimeCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="📊 Таблица истинности формулы" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <DataGrid ItemsSource="{Binding FormulaTruthTable}"
                                                  Background="#16213e"
                                                  Foreground="White"
                                                  BorderBrush="#e94560"
                                                  AutoGenerateColumns="True"
                                                  Height="150"
                                                  IsReadOnly="True"/>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource AnimeCard}">
                                    <StackPanel>
                                        <TextBlock Text="🎯 Нормальные формы формулы" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <TextBlock Text="ДНФ:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"/>
                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding FormulaDnf}"
                                                 Height="40"
                                                 IsReadOnly="True"/>

                                        <TextBlock Text="КНФ:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   Margin="0,5,0,0"/>
                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding FormulaKnf}"
                                                 Height="40"
                                                 IsReadOnly="True"/>
                                    </StackPanel>
                                </Border>

                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                </TabItem>

                <!-- Вкладка 3: Сравнение функций -->
                <TabItem Header="⚖️ Сравнение">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Левая колонка - ввод функций для сравнения -->
                            <StackPanel Grid.Column="0" Margin="0,0,10,0">

                                <Border Style="{StaticResource AnimeCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="🔄 Первая функция" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding FirstFunction}"
                                                 Height="60"
                                                 TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource AnimeCard}">
                                    <StackPanel>
                                        <TextBlock Text="🔄 Вторая функция" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding SecondFunction}"
                                                 Height="60"
                                                 TextWrapping="Wrap"/>

                                        <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                            <Button Content="Проверить эквивалентность" 
                                                    Style="{StaticResource AnimeButton}"
                                                    Command="{Binding CheckEquivalenceCommand}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                            </StackPanel>

                            <!-- Правая колонка - результаты сравнения -->
                            <StackPanel Grid.Column="1" Margin="10,0,0,0">

                                <Border Style="{StaticResource AnimeCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="📈 Результат сравнения" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <TextBlock Text="{Binding EquivalenceResult}" 
                                                   Foreground="White" 
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   TextWrapping="Wrap"/>

                                        <TextBlock Text="Контр-пример:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   Margin="0,10,0,0"/>
                                        <TextBox Style="{StaticResource CodeBox}"
                                                 Text="{Binding CounterExample}"
                                                 Height="30"
                                                 IsReadOnly="True"/>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource AnimeCard}" Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock Text="📊 Таблицы истинности" 
                                                   Foreground="#e94560" 
                                                   FontWeight="Bold" 
                                                   FontSize="14"
                                                   Margin="0,0,0,10"/>

                                        <TextBlock Text="Первая функция:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"/>
                                        <DataGrid ItemsSource="{Binding FirstFunctionTable}"
                                                  Background="#16213e"
                                                  Foreground="White"
                                                  BorderBrush="#e94560"
                                                  AutoGenerateColumns="True"
                                                  Height="100"
                                                  IsReadOnly="True"/>

                                        <TextBlock Text="Вторая функция:" 
                                                   Foreground="#cccccc" 
                                                   FontSize="12"
                                                   Margin="0,5,0,0"/>
                                        <DataGrid ItemsSource="{Binding SecondFunctionTable}"
                                                  Background="#16213e"
                                                  Foreground="White"
                                                  BorderBrush="#e94560"
                                                  AutoGenerateColumns="True"
                                                  Height="100"
                                                  IsReadOnly="True"/>
                                    </StackPanel>
                                </Border>

                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                </TabItem>
            </TabControl>
        </DockPanel>
    </Grid>
</Window>